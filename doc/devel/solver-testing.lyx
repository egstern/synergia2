#LyX 1.5.4 created this file. For more info see http://www.lyx.org/
\lyxformat 276
\begin_document
\begin_header
\textclass article
\language english
\inputencoding auto
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\paperfontsize default
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Section
A test distribution for Poisson solvers
\end_layout

\begin_layout Standard
We want to test solvers to the equation
\begin_inset Formula \[
\nabla^{2}\phi=-\frac{1}{\epsilon}\rho.\]

\end_inset


\end_layout

\begin_layout Standard
We use cylindrical coordinates, where 
\begin_inset Formula \[
\nabla^{2}=\frac{1}{r}\frac{\partial}{\partial r}\left(\frac{1}{r}\frac{\partial\phi}{\partial r}\right)+\frac{1}{r^{2}}\frac{\partial^{2}\phi}{\partial\theta^{2}}+\frac{\partial^{2}\phi}{\partial z^{2}}\]

\end_inset


\end_layout

\begin_layout Standard
The example charge distributions for which there are simple, analytical
 expressions for 
\begin_inset Formula $\phi$
\end_inset

 are typically those which exhibit a very large degree of symmetry, reducing
 the problem to one, or possibly two, dimensions.
 These examples are poor tests for a solver because they do not equally
 test all three dimensions.
\end_layout

\begin_layout Standard
Instead, we work backwards, using a truly three dimensional 
\begin_inset Formula $\phi(r,\theta,z)$
\end_inset

 and differentiating to find the corresponding 
\begin_inset Formula $\rho(r,\theta,z)$
\end_inset

.
 For our closed pipe solver, we have the following boundary conditions:
\begin_inset Formula \[
\phi(r=r_{0},\theta,z)=0\]

\end_inset


\begin_inset Formula \[
\phi(r,\theta=0,z)=\phi(r,\theta=\2\pi,z)\]

\end_inset


\begin_inset Formula \[
\phi(r,\theta,z=-z_{0})=\phi(r,\theta,z=+z_{0})\]

\end_inset

 These conditions are satisfied by the following field
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\phi(r,\theta,z)=\left(-\frac{r^{2}}{r_{0}^{2}}+1\right)\sin^{2}\left(3\theta\right)\cos^{2}\left(\pi\frac{z}{z_{0}}\right),\]

\end_inset


\end_layout

\begin_layout Standard
which has non-trivial dependence on all coordinates.
\end_layout

\begin_layout Standard
The maxima program
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Standard

phi:(-r^2/r0^2+1)*sin(3*theta)^2*cos(%pi*z/z0)^2;
\end_layout

\begin_layout Standard

phir:1/r*diff(r*diff(phi,r),r);
\end_layout

\begin_layout Standard

phitheta:1/r^2*diff(phi,theta,2);
\end_layout

\begin_layout Standard

phiz:diff(phi,z,2);
\end_layout

\begin_layout Standard

rho:-ratsimp(phir+phitheta+phiz);
\end_layout

\begin_layout Standard

load("cformat.lisp");
\end_layout

\begin_layout Standard

cformat(rho); 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
provides the C++-formatted version of the resulting charge density.
\end_layout

\end_body
\end_document
